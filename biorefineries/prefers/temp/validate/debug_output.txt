c:\programming\prefers\biosteam\biosteam\units\design_tools\pressure_vessel.py:104: CostWarning: [38;2;229;63;229m<AeratedFermentation: R302>[0m Vertical vessel length (58.67 ft) is out of bounds (12 to 40 ft) for cost correlation
  return method(pressure, diameter, length)
c:\programming\prefers\biosteam\biosteam\units\aerated_bioreactor.py:263: OptimizeWarning: Unknown solver options: xtol
  minimize_scalar(f, 1.2 * OUR, bounds=[OUR, 10 * OUR], options=dict(xtol=OUR * 1e-3))
c:\programming\prefers\biosteam\biosteam\units\design_tools\pressure_vessel.py:104: CostWarning: [38;2;229;63;229m<AeratedFermentation: R302>[0m Vertical vessel length (58.67 ft) is out of bounds (12 to 40 ft) for cost correlation
  return method(pressure, diameter, length)
c:\programming\prefers\biosteam\biosteam\units\solids_separation.py:178: DesignWarning: [38;2;229;63;229m<Centrifuge: S402>[0m Solids loading (0.6561 ton/hr) is out of bounds (minimum 2 ton/hr).
  lb_warning(self, 'Solids loading', ts, 'ton/hr', lb)
c:\programming\prefers\thermosteam\thermosteam\_stream.py:403: RuntimeWarning: <Stream: SeedSolution1> has been replaced in registry
  self._register(ID)
c:\programming\prefers\thermosteam\thermosteam\_stream.py:403: RuntimeWarning: <Stream: SeedSolution2> has been replaced in registry
  self._register(ID)
c:\programming\prefers\biosteam\biosteam\units\design_tools\pressure_vessel.py:104: CostWarning: [38;2;229;63;229m<AeratedFermentation: R302>[0m Vertical vessel length (57.68 ft) is out of bounds (12 to 40 ft) for cost correlation
  return method(pressure, diameter, length)
c:\programming\prefers\biosteam\biosteam\units\aerated_bioreactor.py:263: OptimizeWarning: Unknown solver options: xtol
  minimize_scalar(f, 1.2 * OUR, bounds=[OUR, 10 * OUR], options=dict(xtol=OUR * 1e-3))
c:\programming\prefers\thermosteam\thermosteam\network.py:1567: RuntimeWarning: <IsenthalpicValve: valve> has been replaced in registry
  self._run()
c:\programming\prefers\biosteam\biosteam\units\design_tools\pressure_vessel.py:104: CostWarning: [38;2;229;63;229m<AeratedFermentation: R302>[0m Vertical vessel length (57.68 ft) is out of bounds (12 to 40 ft) for cost correlation
  return method(pressure, diameter, length)
c:\programming\prefers\biosteam\biosteam\_unit.py:1338: RuntimeWarning: <IsenthalpicValve: _S401_valve> has been replaced in registry
  self._design(**design_kwargs) if design_kwargs else self._design()
c:\programming\prefers\biosteam\biosteam\units\solids_separation.py:178: DesignWarning: [38;2;229;63;229m<Centrifuge: S402>[0m Solids loading (0.8134 ton/hr) is out of bounds (minimum 2 ton/hr).
  lb_warning(self, 'Solids loading', ts, 'ton/hr', lb)
=====================================================================================
LEGHEMOGLOBIN PRODUCTION SYSTEM - DESIGN SPECIFICATION MODE
=====================================================================================

1. Creating system...
ReactionSystem:
[0]  ParallelReaction (by mol):
     index  stoichiometry                                                                                   reactant    X[%]
     [0]    1.06 NH3 + 0.176 FeSO4 + Glucose -> 4.06 H2O + 0.618 O2 + 0.176 (NH4)2SO4 + 0.176 Heme_b        Glucose     0.02
     [1]    1.61 NH3 + 0.0165 (NH4)2SO4 + Glucose -> 3.69 H2O + 0.288 O2 + 6 Globin                         Glucose     0.09
     [2]    1.59 NH3 + 0.00786 (NH4)2SO4 + 0.00786 FeSO4 + Glucose -> 3.7 H2O + 0.303 O2 + 6 Leghemoglobin  Glucose     3.03
[1]  ParallelReaction (by mol):
     index  stoichiometry                                                                      reactant    X[%]
     [0]    0.836 NH3 + 0.0108 (NH4)2SO4 + Glucose -> 2.01 H2O + 0.106 O2 + 6 Pichia_pastoris  Glucose    48.40
     [1]    6 O2 + Glucose -> 6 H2O + 6 CO2                                                    Glucose    48.27
SeedIn1: $0.0000/kg ¡ú $0.4442/kg
SeedIn2: $0.0000/kg ¡ú $0.4442/kg
CultureIn: $0.0000/kg ¡ú $0.4213/kg
Glucose: $0.0000/kg ¡ú $0.4200/kg
NH3_25wt: $0.0000/kg ¡ú $0.1152/kg
DfUltraBuffer: $0.0000/kg ¡ú $1.2182/kg
IXEquilibriumBuffer: $0.0000/kg ¡ú $1.2182/kg
IXElutionBuffer: $0.0000/kg ¡ú $0.1468/kg
IXRegenerationSolution: $0.0000/kg ¡ú $0.2800/kg
DfNanoBuffer: $0.0000/kg ¡ú $0.6324/kg

2. Running baseline simulation...
   [U404] Optimized water recovery: 0.787
   [U404] Total solids: 12.02% (target: 12.00%)
   [U404] Leghemoglobin: 6.71% (target: 7.50%)
   Baseline production rate: 218.54 kg/hr

3. Applying design specification: TARGET_PRODUCTION = 275 kg/hr

============================================================
Setting Production Rate to 275.00 kg/hr
============================================================
Baseline input streams stored: 10 streams
Running initial simulation to establish baseline...
   [U404] Optimized water recovery: 0.787
   [U404] Total solids: 12.02% (target: 12.00%)
   [U404] Leghemoglobin: 6.71% (target: 7.50%)
  Initial production: 218.54 kg/hr
  Target production:  275.00 kg/hr
  Initial scaling guess: 1.2583x
  Search bounds: 0.1x to 5.0x baseline

Solving for optimal scaling factor (intermediate warnings suppressed)...
   [U404] Optimized water recovery: 0.746
   [U404] Total solids: 11.97% (target: 12.00%)
   [U404] Leghemoglobin: 6.86% (target: 7.50%)
   [U404] Optimized water recovery: 0.950
   [U404] Total solids: 12.05% (target: 12.00%)
   [U404] Leghemoglobin: 3.20% (target: 7.50%)
   [U404] WARNING: Leghemoglobin 3.20% outside target range 6-9%
   [U404] Optimized water recovery: 0.361
   [U404] Total solids: 12.00% (target: 12.00%)
   [U404] Leghemoglobin: 7.43% (target: 7.50%)
   [U404] Optimized water recovery: 0.742
   [U404] Total solids: 12.00% (target: 12.00%)
   [U404] Leghemoglobin: 6.89% (target: 7.50%)
    Iteration 4: scale=1.2895x, production=274.42 kg/hr, error=-0.5834 kg/hr
   [U404] Optimized water recovery: 0.742
   [U404] Total solids: 12.02% (target: 12.00%)
   [U404] Leghemoglobin: 6.91% (target: 7.50%)
    Iteration 5: scale=1.2928x, production=274.59 kg/hr, error=-0.4075 kg/hr
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 12.00% (target: 12.00%)
   [U404] Leghemoglobin: 6.90% (target: 7.50%)
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.96% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.96% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.96% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.96% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)
    Iteration 10: scale=1.2930x, production=276.11 kg/hr, error=1.1068 kg/hr
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.95% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.95% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)

Solver converged. Running final validation simulation...
   [U404] Optimized water recovery: 0.740
   [U404] Total solids: 11.95% (target: 12.00%)
   [U404] Leghemoglobin: 6.87% (target: 7.50%)

   Could not achieve target production: 'gbk' codec can't encode character '\u2717' in position 2: illegal multibyte sequence
   Continuing with baseline production rate...

4. Verifying product specifications...

============================================================
Product Specification Check: LegH_3
============================================================

Specification                  Target Range              Actual          Status
-------------------------------------------------------------------------------------

   SPECIFICATION CHECK FAILED: 'gbk' codec can't encode character '\u2713' in position 72: illegal multibyte sequence
   System may require process parameter adjustments to meet specifications.

5. System Summary
=====================================================================================
System: LegH_sys
ins...
[0] SeedIn1  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): (NH4)2SO4  0.0139
                    MgSO4      0.00153
                    KH2PO4     0.00812
                    Glucose    0.0204
[1] SeedIn2  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): (NH4)2SO4  0.139
                    MgSO4      0.0153
                    KH2PO4     0.0812
                    Glucose    0.204
[2] CultureIn  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): FeSO4    0.00375
                    Glycine  0.005
                    Glucose  1.25
[3] Glucose  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): Glucose  5.18
[4] NH3_25wt  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): H2O  6.46
                    NH3  2.28
[5] DfUltraBuffer  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): NaCl    0.197
                    KH2PO4  0.493
                    EDTA    0.0197
[6] IXEquilibriumBuffer  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): NaCl    0.0616
                    KH2PO4  0.154
                    EDTA    0.00616
[7] IXElutionBuffer  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): NaCl    4.02
                    KCl     0.0402
                    KH2PO4  0.1
[8] IXRegenerationSolution  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): NaOH  3.08
[9] DfNanoBuffer  
    phase: 'l', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): NaH2PO4  0.0749
                    Na2HPO4  0.0749
outs...
[0] LegH_3  
    phase: 'l', T: 273.15 K, P: 101325 Pa
    flow (kmol/hr): H2O              13.5
                    H2SO4            3.18e-09
                    NaCl             0.001
                    KCl              1e-05
                    (NH4)2SO4        5.59e-08
                    FeSO4            1.16e-09
                    MgSO4            8.41e-09
                    KH2PO4           2.54e-05
                    NaH2PO4          1.87e-05
                    Na2HPO4          1.87e-05
                    Glycine          3.36e-08
                    Glucose          5.15e-06
                    EDTA             1.32e-07
                    Pichia_pastoris  1.62e-06
                    Glucan           0.0286
                    Mannoprotein     0.316
                    Chitin           0.0014
                    OleicAcid        0.00383
                    RNA              0.00161
                    Heme_b           7.86e-10
                    Globin           0.00106
                    Leghemoglobin    0.855
[1] vent1  
    phase: 'g', T: 298.15 K, P: 101325 Pa
    flow (kmol/hr): CO2  5.04
[2] vent2  
    phase: 'g', T: 305.15 K, P: 101325 Pa
    flow (kmol/hr): O2   64.8
                    N2   271
                    CO2  7.5
[3] effluent1  
    phase: 'l', T: 281.48 K, P: 101325 Pa
    flow (kmol/hr): H2O              30.2
                    H2SO4            0.00636
                    NaCl             4.28
                    KCl              0.0402
                    (NH4)2SO4        0.112
                    FeSO4            0.00231
                    MgSO4            0.0168
                    KH2PO4           0.837
                    NaH2PO4          0.0749
                    Na2HPO4          0.0749
                    Glycine          0.00462
                    Glucose          1.34
                    EDTA             0.0244
                    Pichia_pastoris  0.00848
                    Glucan           0.72
                    Mannoprotein     0.103
                    Chitin           0.0352
                    OleicAcid        0.00124
                    RNA              0.000523
                    Heme_b           0.000205
                    Globin           0.0268
                    Leghemoglobin    0.0407
[4] effluent2  
    phase: 'l', T: 293.15 K, P: 101325 Pa
    flow (kmol/hr): H2O            3.45
                    Na2SO4         0.0154
                    NaHSO4         3.08e-05
                    Glycine        0.000372
                    EDTA           0.00147
                    Mannoprotein   4.31
                    OleicAcid      0.0522
                    RNA            0.0219
                    Leghemoglobin  0.0462
[5] effluent3  
    phase: 'l', T: 293.15 K, P: 101325 Pa
    flow (kmol/hr): H2O     4.44
                    Na2SO4  1.52
                    NaHSO4  0.00305

=====================================================================================
KEY PERFORMANCE INDICATORS
=====================================================================================
  Product Stream:           LegH_3
  Production Rate:          276.10 kg/hr
  Leghemoglobin Content:    6.87%
  Annual Production:        2208.79 metric tons/year
=====================================================================================


6. Generating system diagram...
<IPython.lib.display.IFrame object at 0x000001B636B5E090>

7. Performing LCA analysis...
   LCA Inventory Table generated
   LCA Displacement Allocation Table generated

=====================================================================================
SIMULATION COMPLETE
Target Production:   275.00 kg/hr
Achieved Production: 276.10 kg/hr
=====================================================================================

Simulation finished. 
